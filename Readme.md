# Проект Loan Calculator

Проект Loan Calculator — это приложение для расчета ежемесячных выплат по кредиту. Реализована возможность выбора даты платежа. Сделано ограничение, что выбранный день погашения ежемесячного платежа должен совпадать с днем в месяце закрытия кредита. Проект имеет структуру MVC и состоит из следующих компонентов:

## Компоненты проекта
### Controllers
Контроллер `LoanCalculatorController` предоставляет конечные точки для взаимодействия с приложением.

### Models
Пакет Models содержит модели запросов, ответов и перечисления для типа платежа `PaymentType`.

### Services
Пакет Services содержит сервисы для расчета ежемесячных выплат по кредиту, а также интерфейс `ILoanCalculatorService`.

#### Interfaces
Интерфейс `ILoanCalculatorService` описывает метод для расчета ежемесячных выплат по кредиту.

#### Calculators
Пакет `Calculators` содержит две реализации расчетов ежемесячных выплат по кредиту: `AnnuityLoanCalculator` и `DifferentialLoanCalculator`.

#### LoanCalculatorService
Сервис LoanCalculatorService реализует метод из интерфейса `ILoanCalculatorService` и использует реализации из пакета Calculators.

## Тесты
Проект LoanCalculator.Tests содержит тесты для сервиса `LoanCalculatorService` и реализаций из пакета Calculators. Для unit-тестирования используется NUnit.Framework.

### AnnuityLoanCalculatorTests
Класс `AnnuityLoanCalculatorTests` содержит тесты для реализации `AnnuityLoanCalculator`. Проверяется правильность расчетов для аннуитетного типа платежей. Проверяется, что метод CalculatePayments возвращает ожидаемое количество платежей, что возвращается корректное значение для погашения основного долга. Третий тест проверяет, что общая сумма погашения основного долга равна изначальной сумме кредита. Последний тест проверяет, что при установке значения платежного дня больше 29 дата платежа в феврале будет приходиться на последний день месяца. 

### DifferentialLoanCalculatorTests
Класс `DifferentialLoanCalculatorTests` содержит тесты для реализации `DifferentialLoanCalculator`. Проверки аналогичны вышеописанным. С отличием в методике проверки корректности проверки значения для погашения основного долга и отсутствие проверки переноса дня платежа. Так как в обоих классах для высчитывания следующей даты платежа используется внешний класс NextPaymentCalculator.

### LoanCalculatorServiceTest
Класс `LoanCalculatorServiceTest` содержит тесты для сервиса `LoanCalculatorService`. Тесты проверяют возможность выдачи кредита "задним числом", проверка несовпадения выбранной даты платежа и числа закрытия кредита, успешность создания запроса при корректной передаче данных. 

## Использование
Для запуска проекта нужно запустить проект в Visual Studio. API будет доступно по адресу https://localhost:port/api/LoanCalculator/calculate, где port - порт, на котором запущен проект.

## Пример запроса
Примеры запросов для Postman выложены в файле `LoanCalculator.postman_collection`. В примере выложены три запроса:
- **AnnuityPaymentType** - апрос на расчет месячных выплат для кредита с аннуитетной схемой погашения. Запрос использует HTTP метод POST и принимает JSON-объект, содержащий параметры кредита: сумму кредита, процентную ставку, дату выдачи кредита, дату окончания кредита, тип платежа (аннуитетный или дифференцированный) и день платежа. Возвращает в json-формате список объектов с атрибутами дата платежа, сумма платежа по основному долгу, сумма платежа по процентам, сумма оставшегося после платежа основного долга.
- **DifferentiatedPaymentType** -  запрос на расчет месячных выплат для кредита с дифференцированной схемой погашения. Принцип работы аналогичен `AnnuityPaymentType`.
- **ValidateRequest** - - запрос на проверку валидации параметров кредита. В ответ на запрос возвращается JSON-объект, содержащий сообщения об ошибках валидации параметров кредита, если они есть. Конкретно в этом примере они есть)